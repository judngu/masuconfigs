#RBM Specific tweaks

alias free_slots="rake deploy:show | grep -v '\w@rbm' | grep -v '\-\-\-\-\-\-\-\-\-\-\-'"
alias my_slots="rake deploy:show | grep $USERNAME"
alias slots="rake deploy:show"

export slotbox='att-stg-app-00.dc-00.rbm.local'
for num in 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23; do 
	alias "ct_slot$num"="ssh app$num@att-stg-app-00.dc-00.rbm.local"
	export "SLOT$num"="app$num@att-stg-app-00.dc-00.rbm.local"
	alias "ct_vslot$num"="ssh app@vmm-test-app-00.hq.rbm.local"
	export "VSLOT$num"="vmm-test-app-00.hq.rbm.local"
done
alias "ct_vmm"="ssh app@vmm-test-app-01.hq.rbm.local"
alias "ct_prod"="ssh eliot3.rbm.local"
export PROD=eliot3.rbm.local
export VMM=vmm-test-app-01.hq.rbm.local
function last_sync {
	LAST_SYNC=`grep "^rake deploy:sync" < ~/.bash_history | tail -1`
	if [ -n "$LAST_SYNC" ]; then 
		# I'd like to have it actually call it but whenever there's a space in the description
		# rake deploy:sync[3,"a spacey description"]
		# the command passed to rake is cut off at the first space. Not sure how to fix it.
		echo $LAST_SYNC
		#crude_spaces_helper $LAST_SYNC
	else
		echo "Couldn't find a sync in your history"
	fi
}

function crude_spaces_helper { CMD=$1 ; shift ; $CMD "$*" ; }

PATH=$PATH:/Users/$USERNAME/workspace/rbm_tools

export IPOG_DIR="/Users/$USERNAME/workspace/ipog/"
export VMM_DIR="/Users/$USERNAME/workspace/vmm/"

function deploy_ipog {
	git pull origin master
	echo "Continue and Push to origin? y/n: "
	read continue
	if [ "$continue" == 'y' ] || [ "$continue" == 'Y']; then
		git push origin master
		echo "Continue and deploy? y/n: "
		read continue
		if [ "$continue" == 'y' ] || [ "$continue" == 'Y']; then
			STAG=prod cap deploy
		fi
	fi
}
